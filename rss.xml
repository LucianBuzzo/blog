<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[Lucian Buzzo]]></title><description><![CDATA[A starter blog demonstrating what Gatsby can do.]]></description><link>https://gatsbyjs.github.io/gatsby-starter-blog/</link><generator>RSS for Node</generator><lastBuildDate>Sun, 03 Mar 2019 10:21:06 GMT</lastBuildDate><item><title><![CDATA[Definitions for filtering properties in JSON schema]]></title><description><![CDATA[Using   to remove undefined fields from an object,
is a feature that crops up regularly in JSON schema libraries, but tends to have
some…]]></description><link>https://gatsbyjs.github.io/gatsby-starter-blog//json-schema-filtering/</link><guid isPermaLink="false">https://gatsbyjs.github.io/gatsby-starter-blog//json-schema-filtering/</guid><pubDate>Sat, 02 Mar 2019 19:30:32 GMT</pubDate><content:encoded>&lt;p&gt;Using &lt;code class=&quot;language-text&quot;&gt;additionalProperties: false&lt;/code&gt; to remove undefined fields from an object,
is a feature that crops up regularly in JSON schema libraries, but tends to have
some strange behaviours especially, once the &lt;code class=&quot;language-text&quot;&gt;anyOf&lt;/code&gt; keyword is used.
This article aims to specify the expected functionality of this feature and what
rules it should follow when filtering across different branches of an &lt;code class=&quot;language-text&quot;&gt;anyOf&lt;/code&gt;
keyword.&lt;/p&gt;
&lt;p&gt;When filtering; an object that validates against the provided schema will have
any undefined properties removed if &lt;code class=&quot;language-text&quot;&gt;additionalProperties&lt;/code&gt; is set to &lt;code class=&quot;language-text&quot;&gt;false&lt;/code&gt;.
This behaviour prevents the usual &lt;code class=&quot;language-text&quot;&gt;additionalProperties: false&lt;/code&gt; behaviour from
working. As such when validating an object to see if it is valid against the
provided schema, the value of &lt;code class=&quot;language-text&quot;&gt;additionalProperties&lt;/code&gt; should be evaluated as
though it were set to &lt;code class=&quot;language-text&quot;&gt;true&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;For example, this object:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; bar
&lt;span class=&quot;token key atrule&quot;&gt;baz&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; buzz&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Would normally fail validation against the following schema:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;properties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; string
&lt;span class=&quot;token key atrule&quot;&gt;required&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; foo
&lt;span class=&quot;token key atrule&quot;&gt;additionalProperties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean important&quot;&gt;false&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This is due to the presence of the additional undefined field &lt;code class=&quot;language-text&quot;&gt;baz&lt;/code&gt;. However
because we want to remove undefined fields, rather than simply failing
validation, when the object is validated, a modified version of the schema with
&lt;code class=&quot;language-text&quot;&gt;additionalProperties&lt;/code&gt; set to true should be used. In the example schema above,
internally the filter implementation would validate using the schema:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;properties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; string
&lt;span class=&quot;token key atrule&quot;&gt;required&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; foo
&lt;span class=&quot;token key atrule&quot;&gt;additionalProperties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean important&quot;&gt;true&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The given object is valid against this modified schema, so the filtering logic
can now run using the original schema, removing the undefined property &lt;code class=&quot;language-text&quot;&gt;baz&lt;/code&gt;
and resulting in a final object like this:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; bar&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;To make an analogy, filtering behaves like a cookie cutter:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;There must be enough cookie dough to fill the cutter, otherwise, the dough is cannot be cut.&lt;/li&gt;
&lt;li&gt;If there is excess dough then it is cut away by the cutter.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;A note on &lt;code class=&quot;language-text&quot;&gt;required&lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;If a field is &lt;code class=&quot;language-text&quot;&gt;required&lt;/code&gt;, but it is not defined in &lt;code class=&quot;language-text&quot;&gt;properties&lt;/code&gt;, it should not
be removed. The following two schemas are equivalent:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;properties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token key atrule&quot;&gt;required&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; foo
&lt;span class=&quot;token key atrule&quot;&gt;additionalProperties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean important&quot;&gt;false&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;properties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; any
    &lt;span class=&quot;token key atrule&quot;&gt;additionalProperties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean important&quot;&gt;false&lt;/span&gt;
&lt;span class=&quot;token key atrule&quot;&gt;required&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; foo
&lt;span class=&quot;token key atrule&quot;&gt;additionalProperties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean important&quot;&gt;false&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;Evaluating &lt;code class=&quot;language-text&quot;&gt;anyOf&lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;When filtering using a schema containing &lt;code class=&quot;language-text&quot;&gt;anyOf&lt;/code&gt;, each branch of the &lt;code class=&quot;language-text&quot;&gt;anyOf&lt;/code&gt;
should be merged with top-level properties to create a new schema, which is then
used to validate the object. If validation passes, then the schema can be used
to filter the object.&lt;/p&gt;
&lt;h3&gt;Reconciling &lt;code class=&quot;language-text&quot;&gt;additionalProperties&lt;/code&gt; between &lt;code class=&quot;language-text&quot;&gt;anyOf&lt;/code&gt; branches and the top-level&lt;/h3&gt;
&lt;p&gt;When merging &lt;code class=&quot;language-text&quot;&gt;additionalProperties&lt;/code&gt;, they are combined using an &lt;code class=&quot;language-text&quot;&gt;AND&lt;/code&gt; operator,
where the values are evaluated topmost first.
The following two schemas are equivalent:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# Before merge&lt;/span&gt;
&lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; object
&lt;span class=&quot;token key atrule&quot;&gt;anyOf&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; object
    &lt;span class=&quot;token key atrule&quot;&gt;properties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;token key atrule&quot;&gt;slug&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; string
    &lt;span class=&quot;token key atrule&quot;&gt;additionalProperties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean important&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;required&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; slug
&lt;span class=&quot;token key atrule&quot;&gt;required&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; type
&lt;span class=&quot;token key atrule&quot;&gt;additionalProperties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean important&quot;&gt;false&lt;/span&gt;
&lt;span class=&quot;token key atrule&quot;&gt;properties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; string
    &lt;span class=&quot;token key atrule&quot;&gt;const&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; user&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# After merge&lt;/span&gt;
&lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; object
&lt;span class=&quot;token key atrule&quot;&gt;required&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; type
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; slug
&lt;span class=&quot;token key atrule&quot;&gt;additionalProperties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean important&quot;&gt;false&lt;/span&gt;
&lt;span class=&quot;token key atrule&quot;&gt;properties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; string
    &lt;span class=&quot;token key atrule&quot;&gt;const&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; user
  &lt;span class=&quot;token key atrule&quot;&gt;slug&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; string&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If the &lt;code class=&quot;language-text&quot;&gt;anyOf&lt;/code&gt; branch has &lt;code class=&quot;language-text&quot;&gt;additionalProperties: false&lt;/code&gt;, then the value of
&lt;code class=&quot;language-text&quot;&gt;properties&lt;/code&gt; in the &lt;code class=&quot;language-text&quot;&gt;anyOf&lt;/code&gt; branch will overwrite the value of &lt;code class=&quot;language-text&quot;&gt;properties&lt;/code&gt; and
the top-level schema. This makes the following two schemas equivalent:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# Before merge&lt;/span&gt;
&lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; object
&lt;span class=&quot;token key atrule&quot;&gt;anyOf&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; object
    &lt;span class=&quot;token key atrule&quot;&gt;properties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;token key atrule&quot;&gt;slug&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; string
    &lt;span class=&quot;token key atrule&quot;&gt;additionalProperties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean important&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;required&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; slug
&lt;span class=&quot;token key atrule&quot;&gt;required&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; type
&lt;span class=&quot;token key atrule&quot;&gt;additionalProperties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean important&quot;&gt;false&lt;/span&gt;
&lt;span class=&quot;token key atrule&quot;&gt;properties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; string
    &lt;span class=&quot;token key atrule&quot;&gt;const&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; user&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# After merge&lt;/span&gt;
&lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; object
&lt;span class=&quot;token key atrule&quot;&gt;required&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; type
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; slug
&lt;span class=&quot;token key atrule&quot;&gt;additionalProperties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean important&quot;&gt;false&lt;/span&gt;
&lt;span class=&quot;token key atrule&quot;&gt;properties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;slug&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; string&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This also applies to nested schemas in an &lt;code class=&quot;language-text&quot;&gt;anyOf&lt;/code&gt; branch. This behaviour allows
you to effectively “whitelist” fields inside an object using an &lt;code class=&quot;language-text&quot;&gt;anyOf&lt;/code&gt; branch.
For example:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# Before merge&lt;/span&gt;
&lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; object
&lt;span class=&quot;token key atrule&quot;&gt;anyOf&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; object
    &lt;span class=&quot;token key atrule&quot;&gt;properties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;token key atrule&quot;&gt;slug&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; string
      &lt;span class=&quot;token key atrule&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; object
        properties
          &lt;span class=&quot;token key atrule&quot;&gt;email&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; string
        &lt;span class=&quot;token key atrule&quot;&gt;additionalProperties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean important&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        required
          &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; email
    &lt;span class=&quot;token key atrule&quot;&gt;additionalProperties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean important&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;required&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; slug
      &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; data
&lt;span class=&quot;token key atrule&quot;&gt;required&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; type
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; data
&lt;span class=&quot;token key atrule&quot;&gt;additionalProperties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean important&quot;&gt;false&lt;/span&gt;
&lt;span class=&quot;token key atrule&quot;&gt;properties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; string
    &lt;span class=&quot;token key atrule&quot;&gt;const&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; user
  &lt;span class=&quot;token key atrule&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; object
    properties
      &lt;span class=&quot;token key atrule&quot;&gt;password&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; string
    &lt;span class=&quot;token key atrule&quot;&gt;additionalProperties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean important&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    required
      &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; password&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# After merge&lt;/span&gt;
&lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; object
&lt;span class=&quot;token key atrule&quot;&gt;required&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; type
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; slug
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; data
&lt;span class=&quot;token key atrule&quot;&gt;additionalProperties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean important&quot;&gt;false&lt;/span&gt;
&lt;span class=&quot;token key atrule&quot;&gt;properties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;slug&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; string
  &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; string
    &lt;span class=&quot;token key atrule&quot;&gt;const&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; user
  &lt;span class=&quot;token key atrule&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; object
    properties
      &lt;span class=&quot;token key atrule&quot;&gt;email&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; string
    &lt;span class=&quot;token key atrule&quot;&gt;additionalProperties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean important&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    required
      &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; email&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;Reconciling multiple matching &lt;code class=&quot;language-text&quot;&gt;anyOf&lt;/code&gt; branches&lt;/h3&gt;
&lt;p&gt;If more than one branch of &lt;code class=&quot;language-text&quot;&gt;anyOf&lt;/code&gt; matches the object being filtered, then the
matching branches are first merged together, and then merged with the top-level
schema fields.
When reconciling &lt;code class=&quot;language-text&quot;&gt;additionalProperties&lt;/code&gt; between &lt;code class=&quot;language-text&quot;&gt;anyOf&lt;/code&gt; branches, they are
combined using an &lt;code class=&quot;language-text&quot;&gt;OR&lt;/code&gt; operator,&lt;/p&gt;
&lt;p&gt;For example, given this object:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;45678&lt;/span&gt;
&lt;span class=&quot;token key atrule&quot;&gt;slug&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; user&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;guest
&lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; user
&lt;span class=&quot;token key atrule&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token key atrule&quot;&gt;roles&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;team&apos;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;And the following schema:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; object
&lt;span class=&quot;token key atrule&quot;&gt;anyOf&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; object
    &lt;span class=&quot;token key atrule&quot;&gt;properties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;token key atrule&quot;&gt;slug&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;const&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; user&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;guest
        &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; string
    &lt;span class=&quot;token key atrule&quot;&gt;additionalProperties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean important&quot;&gt;true&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; object
    &lt;span class=&quot;token key atrule&quot;&gt;properties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;token key atrule&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; number
    &lt;span class=&quot;token key atrule&quot;&gt;additionalProperties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean important&quot;&gt;false&lt;/span&gt;
&lt;span class=&quot;token key atrule&quot;&gt;required&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; type
&lt;span class=&quot;token key atrule&quot;&gt;additionalProperties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean important&quot;&gt;true&lt;/span&gt;
&lt;span class=&quot;token key atrule&quot;&gt;properties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; string
    &lt;span class=&quot;token key atrule&quot;&gt;const&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; user&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Both branches of the &lt;code class=&quot;language-text&quot;&gt;anyOf&lt;/code&gt; match the object, so they should be merged
together:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; object
&lt;span class=&quot;token key atrule&quot;&gt;properties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;slug&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;const&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; user&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;guest
    &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; string
  &lt;span class=&quot;token key atrule&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; number
&lt;span class=&quot;token key atrule&quot;&gt;additionalProperties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean important&quot;&gt;true&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This schema is then merged with the top level:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; object
&lt;span class=&quot;token key atrule&quot;&gt;properties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; string
    &lt;span class=&quot;token key atrule&quot;&gt;const&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; user
  &lt;span class=&quot;token key atrule&quot;&gt;slug&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;const&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; user&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;guest
    &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; string
  &lt;span class=&quot;token key atrule&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; number
&lt;span class=&quot;token key atrule&quot;&gt;additionalProperties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean important&quot;&gt;true&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This final schema is then used to filter the object, however in this case, the
&lt;code class=&quot;language-text&quot;&gt;additionalProperties&lt;/code&gt; field is &lt;code class=&quot;language-text&quot;&gt;true&lt;/code&gt;, so no fields are removed from the
object.&lt;/p&gt;
&lt;p&gt;This behaviour makes the following two calls equivalent&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;Filter (
    &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; object
    &lt;span class=&quot;token key atrule&quot;&gt;anyOf&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; object
        &lt;span class=&quot;token key atrule&quot;&gt;properties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;token key atrule&quot;&gt;slug&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token key atrule&quot;&gt;const&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; user&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;guest
            &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; string
        &lt;span class=&quot;token key atrule&quot;&gt;additionalProperties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean important&quot;&gt;true&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; object
        &lt;span class=&quot;token key atrule&quot;&gt;properties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;token key atrule&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; number
        &lt;span class=&quot;token key atrule&quot;&gt;additionalProperties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean important&quot;&gt;false&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;required&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; type
    &lt;span class=&quot;token key atrule&quot;&gt;additionalProperties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean important&quot;&gt;true&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;properties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; string
        &lt;span class=&quot;token key atrule&quot;&gt;const&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; user
    &lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;45678&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;slug&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; user&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;guest
    &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; user
    &lt;span class=&quot;token key atrule&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;roles&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;team&apos;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
)&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;Filter (
    &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; object
    &lt;span class=&quot;token key atrule&quot;&gt;properties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; string
        &lt;span class=&quot;token key atrule&quot;&gt;const&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; user
      &lt;span class=&quot;token key atrule&quot;&gt;slug&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;const&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; user&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;guest
        &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; string
      &lt;span class=&quot;token key atrule&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; number
    &lt;span class=&quot;token key atrule&quot;&gt;additionalProperties&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean important&quot;&gt;true&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;45678&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;slug&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; user&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;guest
    &lt;span class=&quot;token key atrule&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; user
    &lt;span class=&quot;token key atrule&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;roles&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;team&apos;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
)&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;NOTE&lt;/strong&gt;: This behaviour will change depending on the document being filtered, as
different documents will match different &lt;code class=&quot;language-text&quot;&gt;anyOf&lt;/code&gt; branches.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Writing bad Javascript micro libraries]]></title><description><![CDATA[Like many developers, I have a few Javascript libraries that turn to again and
again. I often find myself loading the full
 jQuery  and…]]></description><link>https://gatsbyjs.github.io/gatsby-starter-blog//mini-libs/</link><guid isPermaLink="false">https://gatsbyjs.github.io/gatsby-starter-blog//mini-libs/</guid><pubDate>Wed, 27 May 2015 17:00:00 GMT</pubDate><content:encoded>&lt;p&gt;Like many developers, I have a few Javascript libraries that turn to again and
again. I often find myself loading the full
&lt;a href=&quot;https://jquery.com/&quot;&gt;jQuery&lt;/a&gt; and
&lt;a href=&quot;https://lodash.com/&quot;&gt;lodash&lt;/a&gt;, libraries only to use a handful of methods from each of them.
I’d had it in my mind for a while to write a replacement library for lodash that would
provide a few utility methods like array mapping and type checking but I had
never really got around to actually doing anything. Last Friday I got into
a little back and forth with our new team member Chris Quinn when he sent
me a 3 line Javascript “framework” that deleted cookies. It got me thinking, how
many lines of code do you actually need to make a usable cookie library?&lt;/p&gt;
&lt;p&gt;Ideas started churning and I quickly hacked out a rough version of a tiny cookie
library - it was pretty sloppy and didn’t work particularly well, but I was
captivated by the idea of seeing what else I could come up with. I tried to get my
fellow developers involved in a weekend hack, but my cries of “Lib Wars!” fell
on deaf ears:  this was going to be a solo mission.&lt;/p&gt;
&lt;p&gt;Over the bank holiday I wrote a further 7 Javascript libraries. The goal was to keep them as small as
possible, providing a knife edge of usefulness. I think some of them were
a genuine success, other were pretty miserable failures. I learnt a lot about
writing vanilla Javascript and had a lot of fun. None of them have any
documentation and are barely tested beyond the latest version of chrome (and
even then I’m sure they’re all pretty buggy). I thought I’d detail what I learnt
on each of them here (warning: experienced JS devs may experience extended eye-rolling).&lt;/p&gt;
&lt;h2&gt;&lt;a href=&quot;https://github.com/LucianBuzzo/biscuit&quot;&gt;Biscuit&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Biscuit is the finished version of the cookie lib that kicked it all off. The
name was stolen from Chris in a friendly attempt to draw him into the failed
“Lib Wars” hackathon. Embarrassingly, Biscuit exposed my terrible lack of
understanding when it came to getting and setting cookies through Javascript.
From &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/Document/cookie&quot;&gt;MDN&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;document.cookie is an accessor property with native setter and getter functions,
and consequently is not a data property with a value: what you write is not the
same [as when] you read, everything is always mediated by the JavaScript interpreter.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;When setting a cookie you need to assign a string value in the form &lt;code class=&quot;language-text&quot;&gt;KEY=VALUE&lt;/code&gt; to the document.cookie
variable like so &lt;code class=&quot;language-text&quot;&gt;document.cookie = &amp;#39;foo=bar&amp;#39;&lt;/code&gt;. Additional parameters can be
added by appending them to the string, seperated by &lt;code class=&quot;language-text&quot;&gt;;&lt;/code&gt;. For example, to set a
a cookie to the current domain that will apply to all paths you would use:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;document.cookie = foo=bar; domain=mydomain.com; path=/&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;I’d previously only used the (excellent)
&lt;a href=&quot;https://github.com/carhartl/jquery-cookie&quot;&gt;jquery-cookie&lt;/a&gt; plugin, which
conveniently wraps document.cookie manipulation into something a little easier
to digest, so this was a bit of an eye-opener for me.
I think the finished product was a success, it’s not very flexible but it does
what it says on the tin.&lt;/p&gt;
&lt;h2&gt;&lt;a href=&quot;https://bitbucket.org/snippets/gravitywell_ltd/97jq/js&quot;&gt;Balsa&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;I have to hold my hands up and admit that I had already written a portion of
this library, but I’m including it here because I finished it during my mini hack.
The aim of Balsa was to provide my most used methods from the lodash library in
a smaller package. The big headscratcher for me was figuring out how to write
a function that provides methods that can be accessed through dot notation. The
solution turned out to be surprisingly straightforward. After defining a function,
simply attach methods to it using dot notation.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;function myFunc() {
  return &amp;#39;foobar&amp;#39;;
}

myFunc.hello = function() {
  return &amp;#39;world&amp;#39;;
}

myFunc();
// -&amp;gt; foobar

myFunc.hello();
// -&amp;gt; world&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;You could also assign methods to a function using brackets.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;function multiply(x, y) {
  return x * y;
}

function add(x, y) {
  return x + y;
}

var methods = [multiply, add];

methods.forEach( function( method ) {
  myFunc[method.name] = method;
});

myFunc.add(1, 1);
// -&amp;gt; 2

myFunc.multiply(2, 2);
// -&amp;gt; 4&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;I’m definitely happy with how Balsa turned out and with some polish and testing
I could see myself using it in a production site. Working on Balsa really upped
my confidence with using function attributes (name, arguments etc) and methods
like
&lt;a href=&quot;https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Function/call&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;call()&lt;/code&gt;&lt;/a&gt;
and
&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/apply&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;apply()&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;h2&gt;&lt;a href=&quot;https://bitbucket.org/snippets/gravitywell_ltd/Kde5/awfuljs&quot;&gt;Awful&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;A while ago I came across their Stackoverflow question &lt;a href=&quot;http://stackoverflow.com/questions/3434278/do-dom-tree-elements-with-ids-become-global-variables&quot;&gt;Do DOM tree elements with
ids become global
variables?&lt;/a&gt;.
This highlighted the behaviour where giving an element an id attribute
adds it to it’s parent window element. E.g.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;&amp;lt;h1 id=&amp;quot;title&amp;quot;&amp;gt;A page title&amp;lt;/h1&amp;gt;
&amp;lt;script&amp;gt;
  alert(window.title.innerText); // -&amp;gt; &amp;#39;A page title&amp;#39;
&amp;lt;/script&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;I thought it would be fun to try and wrap this up into a data binding framework
but it wasn’t particularly successful. Changing the values of elements through
the global namespace was already too easy - wrapping it in another Javascript
function just didn’t make any sense. If you can come up with an interesting
way to use this behaviour &lt;a href=&quot;https://bitbucket.org/lbuzzo/awful-js/&quot;&gt;send me a pull
request&lt;/a&gt;!.&lt;/p&gt;
&lt;h2&gt;&lt;a href=&quot;https://github.com/LucianBuzzo/pantry&quot;&gt;Pantry&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;This is a simple alternative to HTML5 storage that stores data as JSON in
&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/Window/name&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;window.name&lt;/code&gt;&lt;/a&gt;.
Writing Pantry was quick and fun, I didn’t learn much but it was good exercise
in writing concise functions. I’d be interested in doing some testing and seeing
how practical this is as a lightweight method of storing small amounts of application data.&lt;/p&gt;
&lt;h2&gt;&lt;a href=&quot;https://github.com/LucianBuzzo/quentin&quot;&gt;Quentin&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Recently I’ve found myself using jQuery for changing CSS classes and DOM
traversal (&lt;code class=&quot;language-text&quot;&gt;find&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;parents&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;children&lt;/code&gt; etc). I wrote Quentin as a replacement
for jQuery that would provide these functions for me in a smaller package (2.4KB minified).
I used
&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/Document/querySelectorAll&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;querySelectorAll&lt;/code&gt;&lt;/a&gt;
to retrieve arrays of matched elements. The
&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/NodeList&quot;&gt;NodeList&lt;/a&gt; returned
is converted to an array which then has the Quentin methods applied to it.
I was keen to have jQuery style chaining of methods e.g:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;$(&amp;#39;ul&amp;#39;).find(&amp;#39;li&amp;#39;).first().addClass(&amp;#39;active&amp;#39;)&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This proved to be particularly tricky. My solution was to use a helper function
to assign the Quentin methods to a provided collection. If the return value
from the Quentin method could have other Quentin methods applied to it, then
I use the helper to attach those functions before returning a value.
The helper function utilises
”&lt;a href=&quot;https://javascriptweblog.wordpress.com/2010/04/05/curry-cooking-up-tastier-functions/&quot;&gt;currying&lt;/a&gt;”
with the help of a method borrowed from the handsome and generous &lt;a href=&quot;https://javascriptweblog.wordpress.com/&quot;&gt;Angus
Croll&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;var methods = [
  addClass, removeClass, hasClass, find, first, last, eq, data, siblings,
  parent, children, toggleClass
];

function wrapMethods(collection) {
  console.log(collection);
  methods.forEach(function(method) {
    collection[method.name] = method.curry(collection);
  });
  collection.find = find.curry(collection);
  return collection;
}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;It’s not particularly pretty or performant, but it does work! I will most likely
revisit Quentin in the future and try to improve its processing speed.&lt;/p&gt;
&lt;p&gt;Overall I’m really pleased with how Quentin turned out. I really recommend
trying out a jQuery-less approach to DOM selectors if you haven’t before.&lt;/p&gt;
&lt;h2&gt;&lt;a href=&quot;https://github.com/LucianBuzzo/loadly&quot;&gt;Loadly&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Loadly is inspired by &lt;a href=&quot;http://glench.com/hash&quot;&gt;Glen Chiacchieri&lt;/a&gt; and the
&lt;a href=&quot;https://github.com/chriso/cli&quot;&gt;cli&lt;/a&gt; node module. It provides a progress bar and
a spinner that are displayed in the browser’s URL bar using a hash fragment.
I experimented with using &lt;code class=&quot;language-text&quot;&gt;document.title&lt;/code&gt; to display the loader which also had
some interesting effects.&lt;/p&gt;
&lt;p&gt;It’s fun and hacky and probably shouldn’t be used anywhere serious!&lt;/p&gt;
&lt;h2&gt;&lt;a href=&quot;https://github.com/LucianBuzzo/enbasic-js&quot;&gt;EnBasic&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;http://ogden.basic-english.org/&quot;&gt;Ogden’s basic english&lt;/a&gt; is a list of 850 words
that, when learnt, &lt;em&gt;“are sufficient for ordinary communication in idiomatic
English”&lt;/em&gt;. The &lt;a href=&quot;http://ogden.basic-english.org/word2000.html&quot;&gt;combined word list&lt;/a&gt;
extends the original 850 words to around 2000, providing and approximate minimum
standard English world list that, when learnt, should allow a student to
proceed on their own without difficulty.
I liked the idea of building a tool that could check text content against this
word list and “mark” words that are not considered &lt;em&gt;Basic English&lt;/em&gt;. I could then
replace these words with text that would, hopefully, be easier to understand for
people whose first language is not English.
Regular expressions alongside the string methods &lt;a href=&quot;https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/String/match&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;match()&lt;/code&gt;&lt;/a&gt;
and
&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/EXSLT/regexp/replace&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;replace&lt;/code&gt;&lt;/a&gt;
were the key to making EnBasic work.
EnBasic is essentially a spelling checker and could be easily adapted to run checks
against any list of words.&lt;/p&gt;
&lt;h2&gt;&lt;a href=&quot;https://github.com/LucianBuzzo/luigi&quot;&gt;Luigi&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Luigi provides an itty bitty replacement for my most used jQuery ajax methods.
I was suprised at how simple it was to implement basic get requests in vanilla Javascript.
POST request were a little trickier, so I went with the straightforward method
of sending payload data as JSON.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;function post(url, data, callback) {
  var req = new XMLHttpRequest();
  req.onload = function() {
    callback(req.responseText);
  };
  var segments = [];
  req.open(&amp;#39;post&amp;#39;, url, true);
  req.setRequestHeader(&amp;#39;Content-Type&amp;#39;, &amp;#39;application\/json&amp;#39;);
  req.send(JSON.stringify(data));
  return req;
}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;One of my favourite methods from Luigi is &lt;code class=&quot;language-text&quot;&gt;pickHTML&lt;/code&gt;. Its behaviour is very
similar to &lt;a href=&quot;https://api.jquery.com/load/&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;jQuery.load()&lt;/code&gt;&lt;/a&gt;, but simply returns
the HTML string instead of inserting it into the DOM. The regex used in this
method is sourced from the must read article &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/HTML_in_XMLHttpRequest&quot;&gt;HTML in
XMLHttpRequest&lt;/a&gt;
on MDN.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;function pickHTML(html, elementId) {
  var regexp = new RegExp(&amp;quot;&amp;lt;(?!\!)\\s*([^\\s&amp;gt;]+)[^&amp;gt;]*\\s+id\\=[\&amp;quot;\&amp;#39;]&amp;quot; + elementId + &amp;quot;[\&amp;quot;\&amp;#39;][^&amp;gt;]*&amp;gt;&amp;quot; ,&amp;quot;i&amp;quot;);
  var res = regexp.exec(html);
  console.log(res);
  return res ? (new RegExp(&amp;#39;(?:(?:.(?!&amp;lt;\\s*&amp;#39; + res[1] + &amp;#39;[^&amp;gt;]*[&amp;gt;]))*.?&amp;lt;\\s*&amp;#39; + res[1] + &amp;#39;[^&amp;gt;]*[&amp;gt;](?:.(?!&amp;lt;\\s*\/\\s*&amp;#39; + res[1] + &amp;#39;\\s*&amp;gt;))*.?&amp;lt;\\s*\/\\s*&amp;#39; + res[1] + &amp;#39;\\s*&amp;gt;)*(?:.(?!&amp;lt;\\s*\/\\s*&amp;#39; + res[1] + &amp;#39;\\s*&amp;gt;))*.?&amp;#39;, &amp;#39;i&amp;#39;)).exec(html.slice(html.indexOf(res[0]) + res[0].length))[0] || &amp;#39;&amp;#39; : &amp;#39;&amp;#39;;
}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Browser support for Luigi seems pretty solid and I think with a little more
work and polish it could be viable for production use.&lt;/p&gt;
&lt;h2&gt;&lt;a href=&quot;https://bitbucket.org/snippets/gravitywell_ltd/yLBA&quot;&gt;ThickFrames&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;This was originally going to be a &lt;a href=&quot;http://glazkov.com/2011/01/14/what-the-heck-is-shadow-dom/&quot;&gt;Shadow DOM&lt;/a&gt;
utility wrapper for web components until I saw the
&lt;a href=&quot;http://caniuse.com/#feat=shadowdom&quot;&gt;caniuse.com&lt;/a&gt; page for Shadow DOM. I wasn’t
keen on using a polyfill and I didn’t want to use technology that wasn’t
implemented in the majority of browsers, so I went with iframes.
My first attempt looked something like this:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;&amp;lt;div data-role=&amp;quot;frame&amp;quot; data-source=&amp;quot;some/component.html&amp;quot;&amp;gt;&amp;lt;/div&amp;gt;

&amp;lt;script&amp;gt;
  function init(node) {
    var nodes = toArray(document.querySelectorAll(&amp;#39;[data-role=&amp;quot;frame&amp;quot;]&amp;#39;));
    nodes.forEach(function(node) {
      node.innerHTML = &amp;#39;&amp;lt;iframe src=&amp;quot;&amp;#39; + node.dataset.source + &amp;#39;&amp;quot;&amp;gt;&amp;lt;/iframe&amp;gt;&amp;#39;;
    });
  }
&amp;lt;/script&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This immediately presented three problems I wanted to solve:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;iframes are automatically set to a static width and height which screws up the
page’s layout and displays scrollbars everywhere.&lt;/li&gt;
&lt;li&gt;Scripts inside the iframes can’t access global variables in the parent window&lt;/li&gt;
&lt;li&gt;CSS styles declared in the parent window don’t get applied inside the iframes&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;For the first issue, I wrote a small function that sets the iframe’s height to that of its internal
&lt;code class=&quot;language-text&quot;&gt;document&lt;/code&gt; element’s &lt;code class=&quot;language-text&quot;&gt;scrollHeight&lt;/code&gt; attribute. As the &lt;code class=&quot;language-text&quot;&gt;scrollHeight&lt;/code&gt; value can
sometimes return a decimal value, I round it up and add 1 pixel to make sure we
don’t see any scroll bars.&lt;/p&gt;
&lt;p&gt;Injecting Javascript global variables from the parent window and making them
available on load had me stumped until I realized that I could create “empty”
iframes by not giving them a &lt;code class=&quot;language-text&quot;&gt;src&lt;/code&gt; attribute (this is a method used by a lot of
WYSIWYG editors to isolate styles). After creating the empty iframe I can access
its &lt;code class=&quot;language-text&quot;&gt;contentWindow&lt;/code&gt; property and assign any variables I want before injecting
HTML content using
&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/Document/write&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;document.write()&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Applying CSS styles is a little bit brutal and involves using
&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/Node/cloneNode&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;cloneNode()&lt;/code&gt;&lt;/a&gt;
to copy styles out of the parent window into the iframe, with any external files
hopefully being served by the browser cache!&lt;/p&gt;
&lt;p&gt;I’m keen on continuing the development of ThickFrames as I think it shows some promise.
I definitely need to make a few changes, for example removing the use of
&lt;code class=&quot;language-text&quot;&gt;data-role&lt;/code&gt; to prevent any unintentional conflict with the &lt;a href=&quot;http://www.w3.org/TR/wai-aria/roles&quot;&gt;ARIA role
model&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;All in all I had a bunch of fun writing all of these and the experience has
deepened my understanding of front end web development and really
boosted my confidence in writing Javascript unaided by libraries.
I will continue to work on these as side projects, hopefully adding
documentation and unit tests!&lt;/p&gt;
&lt;p&gt;Bitbucket repositories for all of the libraries I’ve talked about above are listed here:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://bitbucket.org/lbuzzo/biscuit-js/&quot;&gt;Biscuit&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://bitbucket.org/lbuzzo/Balsa&quot;&gt;Balsa&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://bitbucket.org/lbuzzo/awful-js/&quot;&gt;Awful&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://bitbucket.org/lbuzzo/pantry-js/&quot;&gt;Pantry&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://bitbucket.org/lbuzzo/quentin-js/&quot;&gt;Quentin&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://bitbucket.org/lbuzzo/loadly-js&quot;&gt;Loadly&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://bitbucket.org/lbuzzo/enbasic-js&quot;&gt;EnBasic&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://bitbucket.org/lbuzzo/luigi-js&quot;&gt;Luigi&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://bitbucket.org/lbuzzo/frames/&quot;&gt;ThickFrames&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[How to painlessly deploy Drupal fields]]></title><description><![CDATA[In Drupal 7, deploying new fields from a development environment onto a production server can
be a tricky and time consuming business…]]></description><link>https://gatsbyjs.github.io/gatsby-starter-blog//drupal-field-deployment/</link><guid isPermaLink="false">https://gatsbyjs.github.io/gatsby-starter-blog//drupal-field-deployment/</guid><pubDate>Wed, 29 Apr 2015 17:00:00 GMT</pubDate><content:encoded>&lt;p&gt;In Drupal 7, deploying new fields from a development environment onto a production server can
be a tricky and time consuming business.
Imagine, the following scenario:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;A client requests a new subtitle text field on the sites product nodes, “for better integration of cross-selling marketing
solutions”.&lt;/li&gt;
&lt;li&gt;You create the field in your development environment (MAMP, XAMP, VM etc) by firing up Chrome and clicking though the GUI.&lt;/li&gt;
&lt;li&gt;You check to make sure it all looks good, adding any additional styles or
templating.&lt;/li&gt;
&lt;li&gt;Happy with the changes, you transfer your new styles and template changes to
the production server and then login and faithfully replicate creating the
new subtitle text field on the live site.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;This process of copying changes across would probably involve putting two browser
windows side by side, one on the development site and one on the production
site and making sure that all of the field settings match.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/field-creation-146d6a285bd0027af1cb85cad4863fa1.gif&quot; alt=&quot;Creating a field in the gui...&quot;&gt;&lt;/p&gt;
&lt;p&gt;Manually recreating fields on a production server is a tedious and error prone
business, especially when faced with the prospect of creating multiple new fields.
Ideally this process should be automated and completed in as few steps as possible.&lt;/p&gt;
&lt;p&gt;Much of the site configuration in Drupal 7 is heavily baked into the site’s
database and can be particularly cryptic to unravel. A common way of getting this
configuration into code (and therefore under version control and easily
deployable) is with the use of
the &lt;a href=&quot;https://www.drupal.org/project/features&quot;&gt;Features&lt;/a&gt; and &lt;a href=&quot;https://www.drupal.org/project/strongarm&quot;&gt;Strongarm&lt;/a&gt; modules, but for me this isn’t always
a viable option.&lt;/p&gt;
&lt;p&gt;The process of using Features and Strongarm to deploy updates
is not simple and requires you to split the functionality of your site into
&lt;em&gt;self-contained&lt;/em&gt; parts of code and configuration, which can be a length and
challenging process, especially when working on a site that doesn’t
use this method for deployment.&lt;/p&gt;
&lt;p&gt;My preferred approach in these situations is to
use a site deployment module. If you’re not familiar with creating a custom
module, take a look through the &lt;a href=&quot;https://www.drupal.org/project/examples&quot;&gt;example modules&lt;/a&gt; source code and the
excellent &lt;a href=&quot;https://www.drupal.org/developing/modules/7&quot;&gt;developer guide&lt;/a&gt; on drupal.org.
In short, a site deployment module is a custom
module that utilises a &lt;code class=&quot;language-text&quot;&gt;.install&lt;/code&gt; file to incrementally update a site. These
updates are run by implementing &lt;a href=&quot;https://api.drupal.org/api/drupal/modules%21system%21system.api.php/function/hook_update_N/7&quot;&gt;hook&lt;em&gt;update&lt;/em&gt;N&lt;/a&gt;, where N is the modules
current update number. A basic &lt;code class=&quot;language-text&quot;&gt;.install&lt;/code&gt; file for a site deployment module
can be seen on the &lt;a href=&quot;http://dcycleproject.org/blog/65/basic-install-file-deployment-module&quot;&gt;dcycle&lt;/a&gt; site (a fantastic resource for Drupal automation snippets).
If I were to create a new module called “mysite_deploy” containing this code:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;php&quot;&gt;&lt;pre class=&quot;language-php&quot;&gt;&lt;code class=&quot;language-php&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;/**
 * Example update function that disables Overlay
 */&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;mysite_deploy_update_7001&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// some people don&apos;t like overlay...&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;module_disable&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;overlay&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;I could then push the module code to my production server, enable this module
through the GUI and then run update.php by clicking on the “update script” link
on the modules page. The function &lt;code class=&quot;language-text&quot;&gt;mysite_deploy_update_7001&lt;/code&gt; would then run and
the overlay module would be disabled.&lt;/p&gt;
&lt;p&gt;Using this method to create a new field is surprisingly tricky. Firstly you need
to create the new field using &lt;a href=&quot;https://api.drupal.org/api/drupal/modules!field!field.crud.inc/function/field_create_field/7&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;field_create_field&lt;/code&gt;&lt;/a&gt;, passing
in a valid “field definition array”. The you will need to create an instance for
each place that the new field is used using &lt;a href=&quot;https://api.drupal.org/api/drupal/modules%21field%21field.crud.inc/function/field_create_instance/7&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;field_create_instance&lt;/code&gt;&lt;/a&gt;, this
time using a “field instance definition array”.&lt;/p&gt;
&lt;p&gt;For me, this is a daunting task. The information required to create a new field
is as confusing as it is diverse and becomes even more complicated when your
trying to deploy a non-standard field such as &lt;a href=&quot;https://www.drupal.org/project/entityreference&quot;&gt;entity reference&lt;/a&gt;.
I’m forever forgetting what “widget type” I need to be using and what
“cardinality” actually means.&lt;/p&gt;
&lt;p&gt;Luckily all this information is available through other Drupal API functions,
&lt;em&gt;if the field has already been created&lt;/em&gt;. Using the two functions &lt;a href=&quot;https://api.drupal.org/api/drupal/modules!field!field.info.inc/function/field_info_field/7&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;field_info_field&lt;/code&gt;&lt;/a&gt;
and &lt;a href=&quot;https://api.drupal.org/api/drupal/modules!field!field.info.inc/function/field_info_instance/7&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;field_info_instance&lt;/code&gt;&lt;/a&gt;, I can add something like this to my themes
&lt;code class=&quot;language-text&quot;&gt;template.php&lt;/code&gt; and get all the information I need (as long as I can figure out what my entity type and bundle is).&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;php&quot;&gt;&lt;pre class=&quot;language-php&quot;&gt;&lt;code class=&quot;language-php&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$fieldName&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;field_fancy_marketing_text&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token variable&quot;&gt;$fieldInfo&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;field_info_field&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$fieldName&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token variable&quot;&gt;$bundle&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;product&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token variable&quot;&gt;$entityType&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;node&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token variable&quot;&gt;$fieldInstance&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;field_info_instance&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$entityType&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$fieldName&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$bundle&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;print_r&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$fieldInfo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;print_r&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$fieldInstance&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The problem with this method is that it’s particularly brutal (&lt;a href=&quot;http://php.net/manual/en/function.print-r.php&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;print_r()&lt;/code&gt;&lt;/a&gt; in
template.php?) and I still need to format the printed arrays into valid PHP.
Using &lt;a href=&quot;http://php.net/manual/en/function.var-export.php&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;var_export&lt;/code&gt;&lt;/a&gt; instead of &lt;code class=&quot;language-text&quot;&gt;print_r&lt;/code&gt; helps but it all still feels a bit
clunky. It’s not fast and I’m having to edit unrelated files to get the
information I need.&lt;/p&gt;
&lt;p&gt;A better solution for me was to use a &lt;a href=&quot;http://www.drush.org/en/master/&quot;&gt;Drush&lt;/a&gt; script. If you haven’t come
across Drush before, it is a command line tool that can bootstrap and interface
with Drupal installations in various ways, from clearing caches to updating
modules. I highly recommend it, it’s become an incredibly valuable part of my
Drupal development toolkit.&lt;/p&gt;
&lt;p&gt;After creating a field through the GUI on my development site, I can run the
Drush script from the command line, providing the field’s machine name as an
argument. The script pretty prints code that I can then
copy and paste into a &lt;code class=&quot;language-text&quot;&gt;hook_update_N&lt;/code&gt; function.
The script uses the provided field name to call &lt;code class=&quot;language-text&quot;&gt;field_info_field&lt;/code&gt; and
&lt;code class=&quot;language-text&quot;&gt;field_info_instance&lt;/code&gt;, fetching the necessary field definition and instance
definition arrays. These arrays are then beautified and output to the command line
using the &lt;a href=&quot;https://php.net/manual/en/language.types.string.php#language.types.string.syntax.heredoc&quot;&gt;heredoc style&lt;/a&gt;. This script can be used ‘as is’ as long as it it’s
run from inside a Drupal installation directory.&lt;/p&gt;
&lt;p&gt;I’ve posted the complete annotated script as a &lt;a href=&quot;https://gist.github.com/LucianBuzzo/d892c70d045b9ce32be049ee3d0e143a&quot;&gt;GitHub gist&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;I love this little drush script, but for me it was still bothersome that I had
to drop out of the &lt;code class=&quot;language-text&quot;&gt;.install&lt;/code&gt; file I was working on, run the script and copy and
paste the output. So I wrote a Vim plugin!&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/fieldexport-plugin-e13394f177a8e1cb4a8874e5a6195b93.gif&quot; alt=&quot;Drupal field export vim plugin&quot;&gt;&lt;/p&gt;
&lt;p&gt;Using this plugin I can type the machine name of a field, then go to normal mode
and execute the function &lt;code class=&quot;language-text&quot;&gt;DrupalExportField&lt;/code&gt; (or map the function call to
a leader key - in the example above I’m using the mapping &lt;code class=&quot;language-text&quot;&gt;&amp;lt;Leader&amp;gt;def&lt;/code&gt;). The
word under the cursor is then replaced with the PHP code generated by the drush
script. The code written into the vim buffer can have indentation that doesn’t
match the rest of your file, but by executing the normal mode command &lt;code class=&quot;language-text&quot;&gt;=i{&lt;/code&gt; at
the end of the function we can automagically neaten up the spacing inside the
current code block.&lt;/p&gt;
&lt;p&gt;If you like, you can copy and paste the code below into your .vimrc file or
alternatively you can download the plugin from GitHub &lt;a href=&quot;https://github.com/LucianBuzzo/vim-drupal-field-export&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;vim&quot;&gt;&lt;pre class=&quot;language-vim&quot;&gt;&lt;code class=&quot;language-vim&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;&quot; Get the absolute path of this vimscript&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; s&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;path&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;fnamemodify&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;resolve&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;expand&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;&amp;lt;sfile&gt;:p&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;:h&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;DrupalExportField&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;&quot; Get the word underneath the cursor&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; fieldName &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;expand&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&amp;lt;cword&gt;&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;&quot; Get the root path of the current Drupal installation&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; drupalRoot &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;system&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;drush eval &apos;echo getcwd()&apos;&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;&quot; Execute the drush script (the script should be stored relative to this functions absolute path)&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; exportCode &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;system&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;drush --root=&apos;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;.&lt;/span&gt; drupalRoot &lt;span class=&quot;token operator&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos; &apos;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;.&lt;/span&gt; s&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;path&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;/fieldexport.drush.php --field=&apos;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;.&lt;/span&gt; fieldName&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;&quot; Switch to paste mode&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;paste&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;&quot; Write the export code to the buffer, then neaten up the indentation&lt;/span&gt;
  execute &lt;span class=&quot;token string&quot;&gt;&quot;normal! mqciw\&amp;lt;F10&gt;&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;.&lt;/span&gt; exportCode &lt;span class=&quot;token operator&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;\&amp;lt;F10&gt;\&amp;lt;esc&gt;&apos;q=i{&quot;&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;&quot; Exit paste mode&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;nopaste&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;endfunction&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content:encoded></item><item><title><![CDATA[How to improve your Mac’s terminal part 3 - changing prompt in an SSH session]]></title><description><![CDATA[After improving the prompt in my terminal I was pretty happy with it (see  part
2 of this series ), unfortunately as soon as I fired
up an…]]></description><link>https://gatsbyjs.github.io/gatsby-starter-blog//terminal-improvement-3/</link><guid isPermaLink="false">https://gatsbyjs.github.io/gatsby-starter-blog//terminal-improvement-3/</guid><pubDate>Sun, 19 Apr 2015 17:00:00 GMT</pubDate><content:encoded>&lt;p&gt;After improving the prompt in my terminal I was pretty happy with it (see [part
2 of this series][./terminal-improvement-2]), unfortunately as soon as I fired
up an SSH session I was seeing the “bleurgh” prompt again.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/1c777bc2492dcf54dd2ef433d89ce164/8a142/ssh-bad.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 569px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 3.8664323374340945%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAAAsSAAALEgHS3X78AAAANklEQVQI12N4/fzG/8/v7v7/+OY2kL7z/9PbO/+/vr/7//2rW/9/fHrw/++3x///fH0EponBAOfsS8gnZTAjAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Default ssh prompt&quot;
        title=&quot;&quot;
        src=&quot;/static/1c777bc2492dcf54dd2ef433d89ce164/8a142/ssh-bad.png&quot;
        srcset=&quot;/static/1c777bc2492dcf54dd2ef433d89ce164/3b8d9/ssh-bad.png 148w,
/static/1c777bc2492dcf54dd2ef433d89ce164/c9c62/ssh-bad.png 295w,
/static/1c777bc2492dcf54dd2ef433d89ce164/8a142/ssh-bad.png 569w&quot;
        sizes=&quot;(max-width: 569px) 100vw, 569px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;Getting around this problem wasn’t too hard, I set up a git repository for all
my dot files (&lt;code class=&quot;language-text&quot;&gt;.vimrc&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;.bash_profile&lt;/code&gt;, etc) and created a bash script to
symlink the files to my home directory. Now all I had to do was &lt;code class=&quot;language-text&quot;&gt;git clone&lt;/code&gt; and
run my setup script and I could have the same prompt (and Vim config) in my SSH.&lt;/p&gt;
&lt;p&gt;“Lovely” I thought to myself, but now my SSH session looks exactly the same as
my normal Terminal session, how am I going to be able to tell the difference?
What if I accidentally kill a production server because I got confused?&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/6fdb60d81c6e2ce37db2393f01dcfbf5/859f1/custom-bad.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 314px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 21.337579617834397%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsSAAALEgHS3X78AAAAUElEQVQY02N48+zq/7fPr/3/9OnB/88f7v3/9+3x/z9fH/3/C6TJwQxf3935//X93f+/gIb8+vIQLEiRgf++P/kPwjABSgwDGwgyABlTaigAMWsx1VwaV3cAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Custom prompt dissaproves&quot;
        title=&quot;&quot;
        src=&quot;/static/6fdb60d81c6e2ce37db2393f01dcfbf5/859f1/custom-bad.png&quot;
        srcset=&quot;/static/6fdb60d81c6e2ce37db2393f01dcfbf5/b7574/custom-bad.png 148w,
/static/6fdb60d81c6e2ce37db2393f01dcfbf5/94149/custom-bad.png 295w,
/static/6fdb60d81c6e2ce37db2393f01dcfbf5/859f1/custom-bad.png 314w&quot;
        sizes=&quot;(max-width: 314px) 100vw, 314px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;Solving this problem came in two parts.&lt;/p&gt;
&lt;p&gt;Firstly, I needed to be able to differentiate between a “normal” session and an
SSH session. I did some digging on &lt;a href=&quot;http://stackoverflow.com/&quot;&gt;stackoverflow&lt;/a&gt; and found this little gem.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; is_ssh&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt; -n &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token variable&quot;&gt;$SSH_CLIENT&lt;/span&gt;&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt; -n &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token variable&quot;&gt;$SSH_TTY&lt;/span&gt;&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;then&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; 0
  &lt;span class=&quot;token comment&quot;&gt;# many other tests omitted&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;ps&lt;/span&gt; -o comm&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; -p $PPID&lt;span class=&quot;token variable&quot;&gt;)&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt;
      sshd&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;*/sshd&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; 0&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    esac
  &lt;span class=&quot;token keyword&quot;&gt;fi&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; 1
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The function detects SSH environment variables and will return &lt;code class=&quot;language-text&quot;&gt;true&lt;/code&gt; if they are
available (indicating an SSH session is active).&lt;/p&gt;
&lt;p&gt;Secondly, I needed to be able to change the output of my prompt based on what type
of session I’m in. This was fairly straight forward to cobble together. I
created a function that returns a prompt based on the result of &lt;code class=&quot;language-text&quot;&gt;is_ssh&lt;/code&gt; and
then assigned it to &lt;code class=&quot;language-text&quot;&gt;export PS1&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; get_prompt &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  c&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;\[\033[&quot;&lt;/span&gt;
  p&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token variable&quot;&gt;${c}&lt;/span&gt;38;5;136\]&quot;&lt;/span&gt;

  local_session&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;\[\033[38;5;240m\]ಠ_ಠ\[\e[m\] \[\033[38;5;37m\]\W/\[\e[m\]\[&lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$(&lt;/span&gt;git_color&lt;span class=&quot;token variable&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\]&lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$(&lt;/span&gt;git_branch&lt;span class=&quot;token variable&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\[\033[m\] &apos;&lt;/span&gt;
  ssh_session&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;\[\033[38;5;240m\]\u\[\033[38;5;37m\]@\h\[\em\]\[\033[38;5;125m\] (\@)\[\em\]\[\e[m\] \[\033[38;5;37m\]\W/\[\e[m\]\[&lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$(&lt;/span&gt;git_color&lt;span class=&quot;token variable&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\]&lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$(&lt;/span&gt;git_branch&lt;span class=&quot;token variable&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\[\033[m\] &apos;&lt;/span&gt;

  n&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token variable&quot;&gt;${c}&lt;/span&gt;m]&quot;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; is_ssh&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;then&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;echo&lt;/span&gt; -e &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token variable&quot;&gt;${ssh_session}&lt;/span&gt;&quot;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;echo&lt;/span&gt; -e &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token variable&quot;&gt;${local_session}&lt;/span&gt;&quot;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;fi&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token function&quot;&gt;export&lt;/span&gt; PS1&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$(&lt;/span&gt;get_prompt&lt;span class=&quot;token variable&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The prompt returned by the function when I’m in an SSH session shows the standard
&lt;code class=&quot;language-text&quot;&gt;user@host&lt;/code&gt; ( &lt;code class=&quot;language-text&quot;&gt;\u@\h&lt;/code&gt; ) as well as the current time ( &lt;code class=&quot;language-text&quot;&gt;\@&lt;/code&gt; ).
Now I can quickly see if I’m on a remote machine and ensure that no horrible
command line related accidents happen!&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/6a3e77c29d28c90fe0f8f5e04ed50614/8a142/ssh-better.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 569px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 5.975395430579965%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAAAsSAAALEgHS3X78AAAAQElEQVQI12P49Prm/3cvb/x/9e7u//cfH/z/AMTvP97///3t3f8/n978/+PFrf8/vz76//fb4/9/gPQfKBsXBgDg9kufSGLiVQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;A better SSH prompt&quot;
        title=&quot;&quot;
        src=&quot;/static/6a3e77c29d28c90fe0f8f5e04ed50614/8a142/ssh-better.png&quot;
        srcset=&quot;/static/6a3e77c29d28c90fe0f8f5e04ed50614/3b8d9/ssh-better.png 148w,
/static/6a3e77c29d28c90fe0f8f5e04ed50614/c9c62/ssh-better.png 295w,
/static/6a3e77c29d28c90fe0f8f5e04ed50614/8a142/ssh-better.png 569w&quot;
        sizes=&quot;(max-width: 569px) 100vw, 569px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;One thing still bugged me about this prompt though. The host name &lt;code class=&quot;language-text&quot;&gt;ip-172-31-9-157&lt;/code&gt;
is pretty useless to me. I, like many other developers and sysadmins out there, use a
host config file to create aliases for the machine I work on. A typical entry in
this file looks like this:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;Host myserver
  Hostname 123.45.6.78
  User ec2-user
  IdentityFile ~/path/to/some/private/key&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;With this config file I can connect to a machine by typing &lt;code class=&quot;language-text&quot;&gt;ssh myserver&lt;/code&gt; instead of
&lt;code class=&quot;language-text&quot;&gt;ssh ec2-user@123.45.6.78&lt;/code&gt;. If I could get the prompt to display the alias
I had set then I would definitely know which server I was one. However this is
much easier said than done and coming up with a clean method of doing it proved
to be a bit tricky.&lt;/p&gt;
&lt;p&gt;One option would be to &lt;a href=&quot;http://www.cyberciti.biz/faq/linux-change-hostname/&quot;&gt;change the hostname&lt;/a&gt; within the machine itself, however
this was something I wanted to avoid for a number of reasons.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Setting up a hostname on each machine I work on would be massively time consuming and pretty
boring.&lt;/li&gt;
&lt;li&gt;If I ever changed my local alias I’d have to update the machines hostname.&lt;/li&gt;
&lt;li&gt;If a team mate logged onto a server it could cause problems for them.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;What I needed was an approach that involved as little setup as possible, that left
the machines hostname untouched and could update dynamically based on my local
config.&lt;/p&gt;
&lt;p&gt;The solution I came up with feels like a bit of a hack but has been working
without issue.
In essence, I use the &lt;code class=&quot;language-text&quot;&gt;[command]&lt;/code&gt; parameter of &lt;code class=&quot;language-text&quot;&gt;ssh&lt;/code&gt; to set a Bash variable
and then open a new bash session before the SSH connection closes.
I created a function in my &lt;code class=&quot;language-text&quot;&gt;.bash_profile&lt;/code&gt; called &lt;strong&gt;tunnel&lt;/strong&gt; that wraps the ssh command and adds
arguments, passing my hostname alias through the &lt;code class=&quot;language-text&quot;&gt;[command]&lt;/code&gt; parameter.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; tunnel &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  local HOSTALIAS&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&apos;export MYHOSTALIAS=&lt;span class=&quot;token variable&quot;&gt;$1&lt;/span&gt;; /bin/bash -il&apos;&quot;&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;ssh&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token variable&quot;&gt;$@&lt;/span&gt;&quot;&lt;/span&gt; -t \&apos;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token variable&quot;&gt;$HOSTALIAS&lt;/span&gt;&quot;&lt;/span&gt;\&apos;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In the ssh session bash prompt I replaced the &lt;a href=&quot;http://www.tldp.org/HOWTO/Bash-Prompt-HOWTO/bash-prompt-escape-sequences.html&quot;&gt;“escape sequence”&lt;/a&gt; for the current
machines hostname (&lt;code class=&quot;language-text&quot;&gt;\h&lt;/code&gt;) with a function call. This function will return the
the value of the variable &lt;code class=&quot;language-text&quot;&gt;MYHOSTALIAS&lt;/code&gt; or the current machines hostname if it
isn’t available.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; host_alias &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt; -z &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token variable&quot;&gt;$MYHOSTALIAS&lt;/span&gt;&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;then&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;echo&lt;/span&gt; -e &lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;hostname&lt;/span&gt; -s&lt;span class=&quot;token variable&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$MYHOSTALIAS&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;fi&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The resulting prompt string now looks like this:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;ssh_session&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;\[\033[38;5;240m\]\u\[\033[38;5;37m\]@&lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$(&lt;/span&gt;host_alias&lt;span class=&quot;token variable&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\[\em\]\[\033[38;5;125m\] (\@)\[\em\]\[\e[m\] \[\033[38;5;37m\]\W/\[\e[m\]\[&lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$(&lt;/span&gt;git_color&lt;span class=&quot;token variable&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\]&lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$(&lt;/span&gt;git_branch&lt;span class=&quot;token variable&quot;&gt;)&lt;/span&gt;&lt;/span&gt;\[\033[m\] &apos;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;And the rendered bash prompt now looks like this:&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/4148050c0be713bf48fc97e1c7821eaf/5439f/ssh-bestest.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 570px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 4.912280701754386%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAAAsSAAALEgHS3X78AAAAN0lEQVQI12P48OrG/2evb/9//eH+/y/v7v3/9fzW/x+Pb/z/DmT/+fb4/9+vj/7/AeK/IDYRGADohUvO9nz0ywAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;The bestest ssh prompt&quot;
        title=&quot;&quot;
        src=&quot;/static/4148050c0be713bf48fc97e1c7821eaf/5439f/ssh-bestest.png&quot;
        srcset=&quot;/static/4148050c0be713bf48fc97e1c7821eaf/2349c/ssh-bestest.png 148w,
/static/4148050c0be713bf48fc97e1c7821eaf/2eaa1/ssh-bestest.png 295w,
/static/4148050c0be713bf48fc97e1c7821eaf/5439f/ssh-bestest.png 570w&quot;
        sizes=&quot;(max-width: 570px) 100vw, 570px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;Now I have no problem seeing which server I’m on and I’m not going to be annoying
any co-workers!&lt;/p&gt;
&lt;p&gt;My Terminal &lt;em&gt;feels&lt;/em&gt; right for me, it’s really only cosmetic differences that
i’ve discussed but it’s had a huge difference on my user experience.
By making the software my own I’ve ended up with something that
I actually enjoy using and my work is that much better for it.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[How to improve your Mac’s terminal part 2 - the prompt]]></title><description><![CDATA[My prompt remained largely unchanged for a long time until I came across
 this article  written by the excellent Mark Otto (of Twitter…]]></description><link>https://gatsbyjs.github.io/gatsby-starter-blog//terminal-improvement-2/</link><guid isPermaLink="false">https://gatsbyjs.github.io/gatsby-starter-blog//terminal-improvement-2/</guid><pubDate>Sat, 18 Apr 2015 17:00:00 GMT</pubDate><content:encoded>&lt;p&gt;My prompt remained largely unchanged for a long time until I came across
&lt;a href=&quot;http://markdotto.com/2012/10/18/terminal-hotness/&quot;&gt;this article&lt;/a&gt; written by the excellent Mark Otto (of Twitter bootstrap fame).
In the article he provides a code snippet for your &lt;code class=&quot;language-text&quot;&gt;.bash_profile&lt;/code&gt; to turn your
standard prompt into this:&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/0a8c58f288cd49f95ab6b80fd3c657d6/73742/mdo-prompt.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 15%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsSAAALEgHS3X78AAAAWklEQVQI132MRw6AIBQFyS9URaMUUYze/5S2tUwmeat5wqFl44CJEAmAEN7FzzZiBM/91KWYay3nuR43m9ZoDCmF9Hz+xw4sO08pccqy7jKEENUceCnsB2rHF8tzBVAwO8aEAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Standard bash prompt&quot;
        title=&quot;&quot;
        src=&quot;/static/0a8c58f288cd49f95ab6b80fd3c657d6/40fad/mdo-prompt.png&quot;
        srcset=&quot;/static/0a8c58f288cd49f95ab6b80fd3c657d6/707e9/mdo-prompt.png 148w,
/static/0a8c58f288cd49f95ab6b80fd3c657d6/649e0/mdo-prompt.png 295w,
/static/0a8c58f288cd49f95ab6b80fd3c657d6/40fad/mdo-prompt.png 590w,
/static/0a8c58f288cd49f95ab6b80fd3c657d6/73742/mdo-prompt.png 600w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;I loved it and started using it myself straight away. Unfortunately there were a
few issues with it. The prompt would fragment or completely disappear when cycling up or
down through my command history and I encountered horrible line wrapping issues.&lt;/p&gt;
&lt;p&gt;The issues were mostly resolved in a &lt;a href=&quot;http://markdotto.com/2013/01/13/improved-terminal-hotness/&quot;&gt;later article&lt;/a&gt; and solved entirely by
&lt;a href=&quot;https://gist.github.com/clozed2u/4971506#file-gistfile1-sh&quot;&gt;this lovely gist&lt;/a&gt;. The follow up included code that would &lt;em&gt;change the colour
of your working git branch depending on its status&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;This seemingly insignificant feature is incredibly useful. I’m constantly
reminded to commit my work, resulting in frequent, small commits rather than
behemoths where I’ve completely forgotten when, why and what code I’ve changed.&lt;/p&gt;
&lt;p&gt;I coloured the prompt with the help of &lt;a href=&quot;http://bitmote.com/index.php?post/2012/11/19/Using-ANSI-Color-Codes-to-Colorize-Your-Bash-Prompt-on-Linux&quot;&gt;this wonderful&lt;/a&gt; article by Michael
Plotke and the &lt;a href=&quot;http://ethanschoonover.com/solarized#the-values&quot;&gt;colour value table&lt;/a&gt; on the Solarized site. Here is a basic
but handy script I made for displaying the colours.
(the value need for Terminal is the XTERM column)&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token shebang important&quot;&gt;#!/bin/bash&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# generates an 8 bit color table (256 colors) showing the colors used by&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# Ethan Schnoover&apos;s Solarized theme&lt;/span&gt;

&lt;span class=&quot;token function&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;\nSWATCH SOLARIZED HEX     16/8 TERMCOL  XTERM/HEX   L*A*B      RGB         HSB        &quot;&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;\n------ --------- ------- ---- -------  ----------- ---------- ----------- -----------&quot;&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;\n\033[48;5;234m      \033[m base03    #002b36  8/4 brblack  234 #1c1c1c 15 -12 -12   0  43  54 193 100  21&quot;&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;\n\033[48;5;235m      \033[m base02    #073642  0/4 black    235 #262626 20 -12 -12   7  54  66 192  90  26&quot;&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;\n\033[48;5;240m      \033[m base01    #586e75 10/7 brgreen  240 #585858 45 -07 -07  88 110 117 194  25  46&quot;&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;\n\033[48;5;241m      \033[m base00    #657b83 11/7 bryellow 241 #626262 50 -07 -07 101 123 131 195  23  51&quot;&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;\n\033[48;5;244m      \033[m base0     #839496 12/6 brblue   244 #808080 60 -06 -03 131 148 150 186  13  59&quot;&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;\n\033[48;5;245m      \033[m base1     #93a1a1 14/4 brcyan   245 #8a8a8a 65 -05 -02 147 161 161 180   9  63&quot;&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;\n\033[48;5;254m      \033[m base2     #eee8d5  7/7 white    254 #e4e4e4 92 -00  10 238 232 213  44  11  93&quot;&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;\n\033[48;5;230m      \033[m base3     #fdf6e3 15/7 brwhite  230 #ffffd7 97  00  10 253 246 227  44  10  99&quot;&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;\n\033[48;5;136m      \033[m yellow    #b58900  3/3 yellow   136 #af8700 60  10  65 181 137   0  45 100  71&quot;&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;\n\033[48;5;166m      \033[m orange    #cb4b16  9/3 brred    166 #d75f00 50  50  55 203  75  22  18  89  80&quot;&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;\n\033[48;5;160m      \033[m red       #dc322f  1/1 red      160 #d70000 50  65  45 220  50  47   1  79  86&quot;&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;\n\033[48;5;125m      \033[m magenta   #d33682  5/5 magenta  125 #af005f 50  65 -05 211  54 130 331  74  83&quot;&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;\n\033[48;5;61m      \033[m violet    #6c71c4 13/5 brmagenta 61 #5f5faf 50  15 -45 108 113 196 237  45  77&quot;&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;\n\033[48;5;33m      \033[m blue      #268bd2  4/4 blue      33 #0087ff 55 -10 -45  38 139 210 205  82  82&quot;&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;\n\033[48;5;37m      \033[m cyan      #2aa198  6/6 cyan      37 #00afaf 60 -35 -05  42 161 152 175  74  63&quot;&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;\n\033[48;5;64m      \033[m green     #859900  2/2 green     64 #5f8700 60 -20  65 133 153   0  68 100  60&quot;&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;\n&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;I was feeling pretty happy with myself at this point; the colourscheme was great,
the font was inviting and my bash prompt looked cool and was actually useful to me.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[How to improve your Mac’s terminal part 1]]></title><description><![CDATA[I spend a lot of my time at work using Terminal. Connecting to servers,
managing version control and editing files (I’m a  Vim  user…]]></description><link>https://gatsbyjs.github.io/gatsby-starter-blog//terminal-improvement-1/</link><guid isPermaLink="false">https://gatsbyjs.github.io/gatsby-starter-blog//terminal-improvement-1/</guid><pubDate>Fri, 17 Apr 2015 17:00:00 GMT</pubDate><content:encoded>&lt;p&gt;I spend a lot of my time at work using Terminal. Connecting to servers,
managing version control and editing files (I’m a &lt;a href=&quot;https://jaxbot.me/articles/why-i-use-vim&quot;&gt;Vim&lt;/a&gt; user). Learning how
to use Terminal can be really powerful for a full stack developer, but opening
up the app and seeing the default interface doesn’t exactly shout &lt;em&gt;“Use me! I’m
awesome!”&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/b1027abf1774085c3a3eec787d1911db/95abb/standard-prompt.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 487px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 32.4435318275154%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsSAAALEgHS3X78AAAAYElEQVQY062RUQoAIQhEu4tmWeCP1P1vZigE+7G7sLEfD0ZkBgcTEdkTOWd729+RENEAILjqHfY1NKmqzTkDEbExRmhmPrvQja21oNYaQb13K6WcBbrJqzqu93xc+e+nLKn2rd0cti1sAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Standard bash prompt&quot;
        title=&quot;&quot;
        src=&quot;/static/b1027abf1774085c3a3eec787d1911db/95abb/standard-prompt.png&quot;
        srcset=&quot;/static/b1027abf1774085c3a3eec787d1911db/dd84a/standard-prompt.png 148w,
/static/b1027abf1774085c3a3eec787d1911db/95201/standard-prompt.png 295w,
/static/b1027abf1774085c3a3eec787d1911db/95abb/standard-prompt.png 487w&quot;
        sizes=&quot;(max-width: 487px) 100vw, 487px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;It’s pretty drab (even if your using the snazzy &lt;em&gt;Pro&lt;/em&gt; theme shown above), the
font is spidery, pixelated and hard to read and the information being
shown to me in the prompt is pretty useless as well.
Clearly this kind of display is potentially useful to some people - but it
is doing nothing for me 99% of the time apart from causing me to make a sort of
“bleugghh” noise at the back of my throat.&lt;/p&gt;
&lt;p&gt;After my first few tussles with Terminal I saw that it was a great (some may say
essential) tool, despite the unappealing interface.
I decided to spend the morning making a few teaks, and sat down in front of my
computer with 3 goals in mind.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Make the colour more interesting.&lt;/li&gt;
&lt;li&gt;Use a more stylish typeface that’s hopefully more legible.&lt;/li&gt;
&lt;li&gt;Display a more informative and useful prompt.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;This was many years ago and “a few teaks” has turned into a weird and interesting
adventure into the land of command line customisation that I doubt will ever end.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/cfd6ffe89dd1a3e2a581557607b57456/84e3d/adventure.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 56.26975763962066%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAMCBP/EABYBAQEBAAAAAAAAAAAAAAAAAAQCA//aAAwDAQACEAMQAAAB7Y10gshef//EABkQAQADAQEAAAAAAAAAAAAAAAIAAREQMv/aAAgBAQABBQLNKfCrqP3P/8QAFhEBAQEAAAAAAAAAAAAAAAAAARAR/9oACAEDAQE/ARMn/8QAFREBAQAAAAAAAAAAAAAAAAAAARD/2gAIAQIBAT8BRn//xAAZEAACAwEAAAAAAAAAAAAAAAABIQACEBH/2gAIAQEABj8CVXOEYjv/xAAcEAEAAgEFAAAAAAAAAAAAAAABACEREDFBYaH/2gAIAQEAAT8hKSdjmWCBKzjROwnpHef/2gAMAwEAAgADAAAAEMj/AP/EABgRAAIDAAAAAAAAAAAAAAAAAAEQESFB/9oACAEDAQE/ELAicX//xAAXEQADAQAAAAAAAAAAAAAAAAABEBFB/9oACAECAQE/ECDLNX//xAAdEAEAAgICAwAAAAAAAAAAAAABABEhQRAxUXGB/9oACAEBAAE/EAKhuxPbxDOsAVE+cAwhcmoBWDouN1BSCf/Z&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Adventure time!&quot;
        title=&quot;&quot;
        src=&quot;/static/cfd6ffe89dd1a3e2a581557607b57456/f8fb9/adventure.jpg&quot;
        srcset=&quot;/static/cfd6ffe89dd1a3e2a581557607b57456/e8976/adventure.jpg 148w,
/static/cfd6ffe89dd1a3e2a581557607b57456/63df2/adventure.jpg 295w,
/static/cfd6ffe89dd1a3e2a581557607b57456/f8fb9/adventure.jpg 590w,
/static/cfd6ffe89dd1a3e2a581557607b57456/85e3d/adventure.jpg 885w,
/static/cfd6ffe89dd1a3e2a581557607b57456/d1924/adventure.jpg 1180w,
/static/cfd6ffe89dd1a3e2a581557607b57456/9452e/adventure.jpg 1770w,
/static/cfd6ffe89dd1a3e2a581557607b57456/84e3d/adventure.jpg 1898w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;I’m of the opinion that &lt;strong&gt;bespoke&lt;/strong&gt; = &lt;strong&gt;better&lt;/strong&gt;. A tailor made suit is
always going to be more wearable than something off the shelf at Primark. If I’m
going to be using a piece of software for 30 hours a week or more, it’s got to
be right for &lt;strong&gt;me&lt;/strong&gt;.
Developers are part craftsperson and part writer. Like the writer, much of the job we do is
confined to our own heads. However, unless we choose and maintain the right
tools for ourselves we will end up working twice as hard for half the
productivity.&lt;/p&gt;
&lt;p&gt;In this article I’d like to explain what I’ve done to meet my 3 initial goals
and hopefully inspire you to modify your working environment to meet &lt;strong&gt;your&lt;/strong&gt;
needs.&lt;/p&gt;
&lt;h2&gt;The colourscheme&lt;/h2&gt;
&lt;p&gt;Ok, I know that picking a colour may seem like the least important part of
customizing software but getting the colour right on something is low hanging
fruit. The right colourscheme can make an immediate and profound difference to your experience.
That being said, getting your colours right in software that your going to be reviewing
or editing code in can be a little tricky. Syntax highlighting, comment colours
and linters all require speific contrasting colours to be able to work
effectively.
It’s pretty easy to modify colours in Terminal’s preferences window, but I was
keen to leverage a pre-existing colour palette that had been designed for code
and hopefully avoid the aforementioned syntax/comment/linter headache.
I forget where I first saw it, but I’ve been in love with Ethan Schnoover’s
&lt;a href=&quot;http://ethanschoonover.com/solarized&quot;&gt;Solarized&lt;/a&gt; theme for a long time. There are Solarized themes available as
downloads for both Terminal and Vim, making it very easy to setup.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/4e0b956505fa6950b536c04285569eaa/b2b55/solarized-dualmode.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 492px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 42.27642276422764%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsSAAALEgHS3X78AAAB00lEQVQY003LTUzTcBiA8ReMJkZD4kEhzhDQNSpbO5nrNjuYdKMjOg8mGL26eFXjyQvxNA+eNDExxHgyHrzBxbMkKigz6uiiIP1YGS0r/Nv1Y10dWVjFRYPJL8/tAUn46pqiqQmmLuqIt2plUxcMjd+FNlddq9y0paa91umebXvNMUTghS9LUrFaLSHpgy4XUGXeUJYsddnSli204uh8vcY7OlevcXWdtzXO1lZN9NNEK5r6AypS0TZ5a+OTIxd+VVlbXjAri1Zloa4U3A3W3Sy2ba7VqOw0JK/BeS7vbYteS/HaqN1SYV36ttNUNMTLanlLUxxL0Q1Jr0lIk5EqGlvf1fWSIJVY9uPbd29ez7569nI6//TJvfzD3NQULH6eK7LvZ+fnpmdm8s9f3Hn0OPcgf/Xu/UTu9vCNW4HJm8cnrh8imS4iCQQNgSScGQEsBv0hOBUGLHstiKcHwynfWOYIOXp4mIKTBAzi4CcAC/3t2QgM/dEV2EXuC0a7g9GD4QQcTV7G8XEMH8PimdMkMxDP9NOX/Okr/nTWN8L0nqf3hygIRDtie4bIA+co6KWzODGOEfQANeGLpU5QTF+C6Ylc7ImMHruQ7ouluvH4v/k/nfk3DicFA24yvS8AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;solarized dual display&quot;
        title=&quot;&quot;
        src=&quot;/static/4e0b956505fa6950b536c04285569eaa/b2b55/solarized-dualmode.png&quot;
        srcset=&quot;/static/4e0b956505fa6950b536c04285569eaa/861e4/solarized-dualmode.png 148w,
/static/4e0b956505fa6950b536c04285569eaa/77416/solarized-dualmode.png 295w,
/static/4e0b956505fa6950b536c04285569eaa/b2b55/solarized-dualmode.png 492w&quot;
        sizes=&quot;(max-width: 492px) 100vw, 492px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;”[The theme has been designed] &lt;em&gt;with both precise &lt;a href=&quot;http://en.wikipedia.org/wiki/Lab_colour_space&quot;&gt;CIELAB&lt;/a&gt; lightness
relationships and a refined set of hues based on fixed colour wheel relationships.&lt;/em&gt;”&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;A lot of thought has been put into this colour palette and it shows. The beige
might not be to everyone’s taste but it’s great to still be
able to read my screen at 3am because my IDE &lt;strong&gt;doesn’t look like this:&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/996163a1aff7b6a91f11b84ec5d059e5/79ad4/neonoverload.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 400px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 66.5%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAIDBP/EABYBAQEBAAAAAAAAAAAAAAAAAAIAAf/aAAwDAQACEAMQAAABw1yM0pEy/8QAGRABAAIDAAAAAAAAAAAAAAAAAQACERIh/9oACAEBAAEFAqUGJqLhoxUi9//EABcRAQADAAAAAAAAAAAAAAAAAAABETH/2gAIAQMBAT8BnFv/xAAXEQEAAwAAAAAAAAAAAAAAAAAAERJB/9oACAECAQE/Aa6l/8QAGxAAAgIDAQAAAAAAAAAAAAAAAAERIQIQYXH/2gAIAQEABj8CjJ+ERZQ6FzX/xAAaEAEAAwEBAQAAAAAAAAAAAAABABEhUTFB/9oACAEBAAE/IcOefUA0HogOaOpLzDCG1eJc2f/aAAwDAQACAAMAAAAQ7A//xAAXEQADAQAAAAAAAAAAAAAAAAABESEA/9oACAEDAQE/EAdCZBEN/8QAGBEBAQADAAAAAAAAAAAAAAAAAQARITH/2gAIAQIBAT8QC6Ss9b//xAAcEAEBAAICAwAAAAAAAAAAAAABEQAhMWFxgdH/2gAIAQEAAT8QJQ1pNOmsPuPF5TbPU5yQxPYy7aQPO8DA0AhFNOOtat5z/9k=&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Neon overload&quot;
        title=&quot;&quot;
        src=&quot;/static/996163a1aff7b6a91f11b84ec5d059e5/79ad4/neonoverload.jpg&quot;
        srcset=&quot;/static/996163a1aff7b6a91f11b84ec5d059e5/a7b8e/neonoverload.jpg 148w,
/static/996163a1aff7b6a91f11b84ec5d059e5/575d0/neonoverload.jpg 295w,
/static/996163a1aff7b6a91f11b84ec5d059e5/79ad4/neonoverload.jpg 400w&quot;
        sizes=&quot;(max-width: 400px) 100vw, 400px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;If you’d like to explore more themes, take a look at &lt;a href=&quot;http://terminal.sexy/&quot;&gt;terminal.sexy&lt;/a&gt;. Don’t be put
of by the dubious sounding URL, it’s a web app that allows you to create, preview
and share Terminal themes. Themes can be downloaded as an XML
file and imported it into Terminal through the preferences window.
One “gotcha” with this process is that the file can’t be imported unless you
change the file extension to &lt;code class=&quot;language-text&quot;&gt;.terminal&lt;/code&gt;.&lt;/p&gt;
&lt;h2&gt;The font&lt;/h2&gt;
&lt;p&gt;Like the colourscheme, I thought this would be a quick win, but I didn’t have the
Solarized magic bullet.
Changing the font used in Terminal is as simple as opening the preferences and
clicking &lt;code class=&quot;language-text&quot;&gt;change&lt;/code&gt; under the font header. Unfortunately the choice of fonts
presented here that are suitable for code editing is rather limited.
Luckily there’s a plethora of fonts available for download on the web and this
quickly opened up my options.&lt;/p&gt;
&lt;p&gt;My font of choice was chopping and changing
pretty regularly until I came across the fantastic &lt;a href=&quot;https://github.com/bling/vim-airline&quot;&gt;Airline&lt;/a&gt; plugin for Vim.
Airline looks a bit weird (due to missing characters) unless you use one of
the 14 patched typefaces in the &lt;a href=&quot;https://github.com/powerline/fonts&quot;&gt;Powerline fonts&lt;/a&gt; repository on github. After
playing around with them I ended up using &lt;a href=&quot;http://www.google.com/fonts/specimen/Droid+Sans+Mono&quot;&gt;Droid sans mono&lt;/a&gt;.
Its chunky, reads well and as an Android owner and Google fanboy I feel right at home.&lt;/p&gt;</content:encoded></item></channel></rss>